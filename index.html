<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DmWin Smart Assistant â€“ Color Only</title>

<style>
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:linear-gradient(180deg,#050b1f,#0b1535);
  color:#e8ecff;
}
.container{max-width:420px;margin:20px auto;padding:16px}
.card{
  background:#0e1a3a;
  border:1px solid #1f3b8f;
  border-radius:14px;
  padding:14px;
  margin-bottom:14px;
}
h1{margin:0 0 6px;font-size:20px}
.small{opacity:.7;font-size:13px}
.green{color:#2ecc71}
.red{color:#ff4d4d}
.violet{color:#c77dff}
.wait{color:#f1c40f}
.center{text-align:center}
button{
  background:#12225a;
  border:1px solid #2a4cff;
  color:#fff;
  padding:10px 14px;
  border-radius:10px;
  margin:6px;
  font-size:14px;
}
button:active{transform:scale(.97)}
</style>
</head>

<body>
<div class="container">

<h1>ğŸ§  DmWin Smart Assistant</h1>
<div class="small">Education / analysis only</div>

<div class="card">
ğŸŸ¢ <b>Status:</b> LIVE<br>
â± <span id="timer">--</span>s remaining
</div>

<div class="card" id="predictionBox">Loadingâ€¦</div>

<div class="card" id="resultBox">Waiting for resultâ€¦</div>

<div class="card" id="statsBox"></div>

<div class="center">
<button onclick="resetStats()">ğŸ“Š Reset Stats</button>
<button onclick="resetHardStop()">ğŸ›‘ Reset Hard Stop</button>
</div>

<div class="card">
ğŸ“œ <b>Latest Results</b>
<div id="history"></div>
</div>

<div class="small center">
âš ï¸ No guarantees â€¢ Avoid over-betting â€¢ Stay disciplined
</div>

</div>

<script>
const API="https://draw.ar-lottery01.com/WinGo/WinGo_1M/GetHistoryIssuePage.json?pageNo=1&pageSize=20";

let state=JSON.parse(localStorage.getItem("dmwin_state"))||{
  wins:0,
  losses:0,
  lossStreak:0,
  lastBet:null,
  lastProcessedIssue:null,
  hardStop:false
};

function save(){localStorage.setItem("dmwin_state",JSON.stringify(state));}

function colorOf(n){
  n=Number(n);
  if(n===0) return "red,violet";
  if(n===5) return "green,violet";
  return n%2===0?"red":"green";
}

function analyze(list){
  if(state.hardStop) return {action:"WAIT",reason:"Hard stop active"};

  const last6=list.slice(0,6).map(i=>colorOf(i.number));
  let g=0,r=0,v=0;

  last6.forEach(c=>{
    if(c.includes("green")) g++;
    if(c.includes("red")) r++;
    if(c.includes("violet")) v++;
  });

  if(v>=3) return {action:"WAIT",reason:"High violet risk"};

  let pick=g>r?"GREEN":"RED";
  let confidence=Math.round((Math.max(g,r)/6)*100);

  // Anti-streak logic
  if(state.lossStreak===1){
    pick=state.lastBet==="green"?"RED":"GREEN";
    confidence-=10;
  }

  if(state.lossStreak>=2){
    return {action:"WAIT",reason:"Cooldown after losses"};
  }

  return {action:pick,confidence};
}

async function tick(){
  const res=await fetch(API);
  const json=await res.json();
  const list=json.data.list;
  const currentIssue=list[0].issueNumber;
  const latestColor=colorOf(list[0].number);

  // RESULT CHECK (ONCE PER ISSUE)
  if(state.lastBet && state.lastProcessedIssue!==currentIssue){
    if(latestColor.includes(state.lastBet)){
      state.wins++;
      state.lossStreak=0;
      resultBox.innerHTML="âœ… Last Bet: <span class='green'>WIN</span>";
    }else{
      state.losses++;
      state.lossStreak++;
      resultBox.innerHTML="âŒ Last Bet: <span class='red'>LOSS</span>";
      if(state.lossStreak>=3) state.hardStop=true;
    }
    state.lastBet=null;
    state.lastProcessedIssue=currentIssue;
    save();
  }

  const d=analyze(list);
  if(d.action==="WAIT"){
    predictionBox.innerHTML=
      "â¸ <b>Prediction:</b> <span class='wait'>WAIT</span><br>"+
      "<span class='small'>"+d.reason+"</span>";
  }else{
    predictionBox.innerHTML=
      "ğŸ¯ <b>Prediction:</b> "+
      "<span class='"+d.action.toLowerCase()+"'>"+d.action+"</span><br>"+
      "<span class='small'>Confidence: "+d.confidence+"%</span>";
    state.lastBet=d.action.toLowerCase();
    save();
  }

  const total=state.wins+state.losses;
  const acc=total?Math.round((state.wins/total)*100):0;
  statsBox.innerHTML=
    `ğŸ“Š Wins: ${state.wins} | âŒ Losses: ${state.losses} | ğŸ¯ Accuracy: ${acc}%`;

  history.innerHTML=list.slice(0,5).map(i=>{
    let c=colorOf(i.number);
    let cls=c.includes("green")?"green":"red";
    if(c.includes("violet")) cls="violet";
    return `<div class="${cls}">${i.issueNumber} â†’ ${c}</div>`;
  }).join("");
}

function resetStats(){
  state.wins=0;
  state.losses=0;
  save();
  alert("Stats reset");
}

function resetHardStop(){
  state.hardStop=false;
  state.lossStreak=0;
  save();
  alert("Hard stop cleared");
}

// TIMER
setInterval(()=>{
  document.getElementById("timer").innerText=60-new Date().getSeconds();
},500);

tick();
setInterval(tick,60000);
</script>

</body>
</html>
