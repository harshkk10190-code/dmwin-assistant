<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ğŸ§  DmWin Color Assistant</title>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: linear-gradient(180deg,#050b1f,#0b1535);
  color: #e8ecff;
}
.container {
  max-width: 420px;
  margin: 20px auto;
  padding: 16px;
}
.card {
  background: #0e1a3a;
  border: 1px solid #1f3b8f;
  border-radius: 12px;
  padding: 14px;
  margin-bottom: 14px;
}
h1 {
  font-size: 20px;
  margin: 0 0 6px;
}
.small {
  opacity: .7;
  font-size: 13px;
}
.green { color: #2ecc71 }
.red { color: #ff4d4d }
.violet { color: #c77dff }
.wait { color: #f1c40f }
hr { border: none; border-top: 1px solid #1f3b8f; margin: 10px 0 }
</style>
</head>

<body>
<div class="container">

<h1>ğŸ§  DmWin Color Assistant</h1>
<div class="small">ğŸ“˜ Education / analysis only</div>

<div class="card">
  ğŸŸ¢ <b>Status:</b> <span class="green">LIVE</span><br>
  ğŸ”„ <span class="small">Manual refresh â€¢ Auto fetch every 60s</span>
</div>

<div class="card" id="predictionBox">
  â³ Loading predictionâ€¦
</div>

<div class="card" id="resultBox">
  ğŸ§¾ Waiting for resultâ€¦
</div>

<div class="card" id="statsBox">
  ğŸ“Š Wins: 0 | âŒ Losses: 0 | ğŸ¯ Accuracy: 0%
</div>

<div class="card">
  ğŸ“œ <b>Latest Results</b>
  <div id="history"></div>
</div>

<div class="small">âš ï¸ No guarantees â€¢ Avoid over betting â€¢ Stay disciplined</div>

</div>

<script>
const API =
"https://draw.ar-lottery01.com/WinGo/WinGo_1M/GetHistoryIssuePage.json?pageNo=1&pageSize=10";

let lastPredictedPeriod = null;
let lastPrediction = null;
let wins = 0, losses = 0;

function colorOf(n){
  n = Number(n);
  if(n === 0) return "red,violet";
  if(n === 5) return "green,violet";
  return n % 2 === 0 ? "red" : "green";
}

function analyze(list){
  const colors = list.map(i => colorOf(i.number));
  const pure = colors.filter(c => !c.includes("violet"));

  const greenCount = pure.filter(c => c==="green").length;
  const redCount   = pure.filter(c => c==="red").length;
  const violetCount = colors.filter(c => c.includes("violet")).length;

  // ğŸ›‘ Defensive rules
  if(violetCount >= 2)
    return {action:"WAIT", reason:"âš ï¸ Violet risk high"};

  if(greenCount >= 4 && redCount <= 1)
    return {action:"WAIT", reason:"ğŸ” Green streak trap"};

  if(redCount >= 4 && greenCount <= 1)
    return {action:"WAIT", reason:"ğŸ” Red streak trap"};

  if(greenCount > redCount)
    return {action:"GREEN", confidence:"ğŸŸ¡ MEDIUM"};

  if(redCount > greenCount)
    return {action:"RED", confidence:"ğŸŸ¡ MEDIUM"};

  return {action:"WAIT", reason:"ğŸ˜´ No clear bias"};
}

async function tick(){
  const res = await fetch(API);
  const json = await res.json();
  const list = json.data.list;

  const currentPeriod = list[0].issueNumber;
  const analysis = analyze(list);

  // ğŸ¯ Prediction (for NEXT round)
  const box = document.getElementById("predictionBox");
  if(analysis.action === "WAIT"){
    box.innerHTML = `
      ğŸ¯ <b>Prediction:</b> <span class="wait">WAIT</span><br>
      <span class="small">${analysis.reason}</span>
    `;
    lastPrediction = null;
    lastPredictedPeriod = null;
  } else {
    box.innerHTML = `
      ğŸ¯ <b>Prediction:</b>
      <span class="${analysis.action.toLowerCase()}">${analysis.action}</span><br>
      <span class="small">Confidence: ${analysis.confidence}</span>
    `;
    lastPrediction = analysis.action;
    lastPredictedPeriod = currentPeriod;
  }

  // ğŸ§¾ Result check (only once per period)
  const resultBox = document.getElementById("resultBox");
  if(lastPrediction && lastPredictedPeriod !== currentPeriod){
    const resultColor = colorOf(list[1].number);
    if(resultColor.includes(lastPrediction.toLowerCase())){
      wins++;
      resultBox.innerHTML = `ğŸŸ¢ Last Result: <b class="green">WIN âœ…</b>`;
    } else {
      losses++;
      resultBox.innerHTML = `ğŸ”´ Last Result: <b class="red">LOSS âŒ</b>`;
    }
    lastPrediction = null;
  }

  const total = wins + losses;
  const acc = total ? Math.round((wins/total)*100) : 0;
  document.getElementById("statsBox").innerText =
    `ğŸ“Š Wins: ${wins} | âŒ Losses: ${losses} | ğŸ¯ Accuracy: ${acc}%`;

  // ğŸ“œ History
  document.getElementById("history").innerHTML =
    list.slice(0,5).map(i => {
      const c = colorOf(i.number);
      const cls = c.includes("green") ? "green" : c.includes("red") ? "red" : "violet";
      return `<div class="${cls}">ğŸ”¹ ${i.issueNumber} â†’ ${c}</div>`;
    }).join("");
}

tick();
setInterval(tick, 60000);
</script>

</body>
</html>
